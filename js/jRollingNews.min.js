!function(t){var e={init:function(e){var o=t.extend({position:"bottom",background_color:"#044A99",content:"none",feed:"http://rss.nytimes.com/services/xml/rss/nyt/Europe.xml",scroll_speed:70,text_color:"#ffffff",opacity:80,line_height:30,pop_links_color:"#042344",open_popup_links_in_new_page:"true",font_family:"default",number_of_retreived_feeds:"20",popup_title_color:"#ffffff",minimize_at_start:"false",loop_for:0,after_loops:"hide",padding_bottom:"true",padding_top:"false",remove_last_separator:"false",bars_z_index:3,popup_min_width:150,popup_max_width:800,scroll_rss_content:"false",hide_title_for_scrolled_content:"false",refresh_news_timer:15},e);return this.each(function(){function e(){if("none"==r){var e="https://query.yahooapis.com/v1/public/yql?q=select * from rss(0, "+o.number_of_retreived_feeds+") where url='"+o.feed+"'";t.getJSON(e,{format:"json"}).done(function(t){if(!t||!t.query.count)return!1;for(var e=new Array,r=new Array,n=new Array,p=new Array,s=0;s<t.query.results.item.length;s++){var d=t.query.results.item[s];r[s]=d.title,p[s]=d.link,"false"==o.number_of_retreived_feeds?e[s]=d.description:(e[s]="",d.description&&(e[s]=d.description.replace(/<[^>]*>/g,"")));var _=d.pubDate.split(" ");n[s]=_[0]+" "+_[1]+" "+_[2]+" "+_[3]}i(a,r,e,p,n)})}else{for(var n=new Array,p=new Array,s=new Array,d=0;d<r.length;d++){var _=r[d];n[d]=_.title,p[d]=_.content,s[d]=_.url}i(a,n,p,s)}}function i(e,i,r,a,n){function p(t,e){function i(){t.children().removeData().remove().end().remove(),c.empty().append(r),p(r),delete t,t=null}if(1!=e){if(z++,0!=A&&z>A){if(A=0,"stop"==o.after_loops)return;"hide"==o.after_loops?c.parent().stop().animate({height:"0px"},500,function(){}):"minimize"==o.after_loops&&l.trigger("click")}var r=t.clone(!0);t.parent().append(r);var a="-"+t.width();t.parent().unbind().mouseenter(function(){if(t.is(":animated"))return void t.stop()}).mouseleave(function(){var e=t.width()+t.offset().left,o=e*k/t.width();t.stop().animate({"margin-left":a},o,"linear",i)}),t.stop().animate({"margin-left":a},k,"linear",i)}}if(!n)var n="";var s,d=i.length;t("#text_scroller_top").length<=0?(s=t("<div>").attr("id","text_scroller_top").addClass("text_scroller_top"),s.css({"z-index":o.bars_z_index})):s=t("#text_scroller_top");var _,l=t("<div>").addClass("toggle_button_minimize");_=t("#text_scroller_bottom").length<=0?t("<div>").attr("id","text_scroller_bottom").addClass("text_scroller_bottom").css({"z-index":o.bars_z_index}):t("#text_scroller_bottom"),t("body").append(s).append(_),e.css({"background-color":"transparent",float:"left",width:"100%",overflow:"hidden",position:"relative",height:o.line_height+"px","line-height":o.line_height+"px",color:o.text_color,bottom:"0px",clear:"both"}),"top"==o.position?0==s.find(e).length&&s.append(e):0==_.find(e).length&&_.append(e),e.attr("added_pad_top",o.padding_top).attr("added_pad_bottom",o.padding_bottom),"default"!=o.font_family&&e.css({"font-family":o.font_family});var c=t("<div class='bar_double_size'></div>");e.append(c),e.append(l);var h=t("<div class='bar_single_size'></div>");h.css({filter:"alpha(opacity='"+o.opacity+"'",opacity:o.opacity/100,"background-color":o.background_color}),e.append(h);var f=t("<div class='bar_items_container'></div>");c.append(f);for(var u="",m=0,v=0;v<d;v++){var g="",b=i[v];"true"==o.scroll_rss_content&&(g=r[v],"true"==o.hide_title_for_scrolled_content&&(b=""));var w="";"true"==o.scroll_rss_content&&"true"!=o.hide_title_for_scrolled_content&&(w=" <span class='title_separator'>&nbsp;</span> "),u=t("<div>").addClass("content_item").append(b+w+g);var x=t("<div class='content_separator'>&nbsp;</div>");if(r){var y="";r&&r[v]?u.attr("content",r[v]):u.attr("content",""),i&&i[v]?(u.attr("pop_title",i[v]),y=i[v]):u.attr("pop_title",""),n&&n[v]?u.attr("pop_date",n[v]):u.attr("pop_date",""),a&&a[v]?(u.attr("pop_link",a[v]),y="<a href='"+a[v]+"' target='_new'>"+i[v]+"</a>"):u.attr("pop_link",""),u.attr("pop_position",o.position),u.attr("title_with_link",y)}f.append(t(u)),v<d-1?f.append(t(x)):"true"!=o.remove_last_separator&&f.append(t(x)),x.css("height",o.line_height+"px"),m=m+f.width()+u.width()+t(x).width()}e.on("click",".content_item",function(){t("#popup_container").length>0&&t("#popup_container").remove();var i=t("<div id='popup_container'><div class='pop_background'></div><div class='pop_content'><div class='pop_close'></div><div class='pop_title'>"+t(this).attr("title_with_link")+"</div><div class='pop_date'>"+t(this).attr("pop_date")+"</div>"+t(this).attr("content")+"</div></div>");i.css({"z-index":o.bars_z_index}),"bottom"==t(this).attr("pop_position")?i.css({bottom:t("#text_scroller_bottom").height()+"px",color:o.text_color}):i.css({top:t("#text_scroller_top").height()+"px",color:o.text_color}),i.attr("popup_opener",e.attr("id")),"default"!=o.font_family&&i.css({"font-family":o.font_family},{"z-index":o.bars_z_index}),t("body").append(i),o.popup_min_width>o.popup_max_width&&(o.popup_min_width=o.popup_max_width),o.popup_max_width<o.popup_min_width&&(o.popup_max_width=o.popup_min_width),i.width()<o.popup_min_width&&i.width(o.popup_min_width),i.width()>o.popup_max_width&&i.width(o.popup_max_width),i.find("a").css({color:o.pop_links_color}),t(".pop_background").css({"background-color":o.background_color,filter:"alpha(opacity='"+o.opacity+"'",opacity:o.opacity/100}),t(".pop_content").css({color:o.text_color}),t(".pop_content img").css({"margin-left":"10px","margin-right":"10px"}),t(".pop_close").click(function(){t("#popup_container").fadeOut(500,function(){t("#popup_container").remove()})}),t(".pop_title a").css({color:o.popup_title_color}),"default"!=o.open_popup_links_in_new_page&&("true"==o.open_popup_links_in_new_page?i.find("a").attr("target","_new"):i.find("a").attr("target","")),i.fadeIn(500)}),f.css({color:o.text_color}),f.width()<e.width()&&(f.width(e.width()),m=e.width()),c.css("width",2*m+"px"),l.attr("parent_bar",e.attr("id")),l.click(function(){t("#"+t(this).attr("parent_bar")).width()!=t(this).width()?(e.attr("id")==t("#popup_container").attr("popup_opener")&&t("#popup_container").fadeOut(500,function(){t("#popup_container").remove()}),t("#"+t(this).attr("parent_bar")).animate({width:t(this).width()+"px"},300,function(){l.removeClass().addClass("toggle_button_maximize"),l.fadeIn(300),t(this).find(".bar_items_container").trigger("mouseenter")})):t("#"+t(this).attr("parent_bar")).animate({width:"100%"},300,function(){l.removeClass().addClass("toggle_button_minimize"),t(this).find(".bar_items_container").trigger("mouseleave")})}),e.mouseenter(function(){l.fadeIn(300)}).mouseleave(function(){e.width()!=l.width()&&l.fadeOut(300)});var k=f.width()/o.scroll_speed*1e3,z=0;p(f);var A=o.loop_for;if("true"==o.minimize_at_start&&l.trigger("click"),"true"==o.padding_bottom){var C=0;t("#text_scroller_bottom>div").each(function(){"false"!=t(this).attr("added_pad_bottom")&&(C+=t(this).height())}),t("body").css({"padding-bottom":_.height()+"px"})}if("true"==o.padding_top){var j=0;t("#text_scroller_top>div").each(function(){"false"!=t(this).attr("added_pad_top")&&(j+=t(this).height())}),t("body").css({"padding-top":j+"px"})}e.find(".bar_double_size").stop().fadeIn(1e3)}var r=o.content,a=t(this);if(0!=o.refresh_news_timer&&"none"==r)var n=setInterval(function(){a.find(".bar_double_size").stop().fadeOut(800,function(){a.children().removeData().remove().end().removeData(),e()})},6e4*o.refresh_news_timer);a.data("timer",n),e()})},destroy:function(){var e=0,o=0;t("#text_scroller_top>div").each(function(){"false"!=t(this).attr("added_pad_top")&&(e+=t(this).height())}),t("#text_scroller_bottom>div").each(function(){"false"!=t(this).attr("added_pad_bottom")&&(o+=t(this).height())}),"false"!=this.attr("added_pad_top")&&t("body").css({"padding-top":e-t(this).height()+"px"}),"false"!=this.attr("added_pad_bottom")&&t("body").css({"padding-bottom":o-t(this).height()+"px"}),clearInterval(this.data("timer"));var i=this.empty().removeClass().attr("style","");return i}};t.fn.jRollingNews=function(o){return e[o]?e[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void t.error("Method "+o+" does not exist on jQuery.jRollingNews"):e.init.apply(this,arguments)}}(jQuery);